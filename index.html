<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0B0D10" />
  <title>Daily Journal</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="assets/icon-192.png?v=9" sizes="192x192" />
  <link rel="apple-touch-icon" href="assets/icon-192.png" />
  <link rel="stylesheet" href="assets/style.css?v=9" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img class="brand-logo" src="assets/logo-xdrip.png?v=9" alt="Daily Journal logo" />
      <div class="brand-text">
        <div class="title">Daily Journal</div>
        <div class="subtitle">Local-first. Elegant. Yours.</div>
      </div>
    </div>

    <div class="top-actions">
      <div class="datebox" role="group" aria-label="Date controls">
        <button class="iconbtn" id="prevDay" title="Previous day" aria-label="Previous day">‚Äπ</button>
        <input type="date" id="entryDate" />
        <button class="iconbtn" id="nextDay" title="Next day" aria-label="Next day">‚Ä∫</button>
      </div>

      <div class="status" id="saveStatus" aria-live="polite">Ready</div>

      <div class="menubar">
        <button class="btn" id="historyBtn" title="History">History</button>
        <button class="btn btnMetal" id="exportBtn" title="Export">Export</button>
        <button class="btn" id="templatesBtn" title="Templates">Templates</button>
        <button class="btn" id="helpBtn" title="Help">Help</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="cardHead">
        <h2>Prompts & Responses</h2>
        <div class="cardActions">
          <button class="btn" id="addPromptBtn">Add prompt</button>
          <button class="btn" id="clearTodayBtn" title="Clear today's content">Clear today</button>
        </div>
      </div>

      <div class="promptList" id="promptList"></div>

      <div class="freewrite">
        <div class="freewriteHead">
          <h3>Free write</h3>
          <span class="hint">Optional ‚Äî for the words that arrive without being asked.</span>
        </div>
        <textarea id="freeWrite" placeholder="Write freely..."></textarea>
      </div>
    </section>

    <aside class="card side">
      <div class="cardHead">
        <h2>Quick notes</h2>
        <div class="chipRow">
          <button class="chip" data-insert="üí° Insight: ">Insight</button>
          <button class="chip" data-insert="üß≠ Direction: ">Direction</button>
          <button class="chip" data-insert="üß± Boundary: ">Boundary</button>
          <button class="chip" data-insert="ü´Ä Feeling: ">Feeling</button>
        </div>
      </div>

      <label class="field">
        <div class="fieldLabel">Headline</div>
        <input id="headline" type="text" placeholder="One sentence that names today." />
      </label>

      <label class="field">
        <div class="fieldLabel">Mood</div>
        <input id="mood" type="range" min="1" max="10" value="6" />
        <div class="rangeRow">
          <span>Low</span><span>High</span>
        </div>
      </label>

      <label class="field">
        <div class="fieldLabel">Highlights</div>
        <textarea id="highlights" placeholder="Key moments, wins, lessons..."></textarea>
      </label>

      <label class="field">
        <div class="fieldLabel">Gratitude</div>
        <textarea id="gratitude" placeholder="What mattered. What held you up."></textarea>
      </label>

      <div class="sideFooter">
        <button class="btn btnMetal" id="printBtn" title="Print / Save as PDF">Print / PDF</button>
        <button class="btn" id="backupBtn" title="Export all entries as JSON backup">Backup all</button>
      </div>

      <div class="tinyNote">
        Saved locally on this device. Use <strong>Backup all</strong> weekly if you want peace of mind.
      </div>
    </aside>
  </main>

  <!-- Export Menu -->
  <div class="modalBackdrop hidden" id="exportModal" role="dialog" aria-modal="true" aria-label="Export options">
    <div class="modal">
      <div class="modalHead">
        <h3>Export</h3>
        <button class="iconbtn" id="closeExport" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="grid2">
          <button class="bigBtn" id="exportHtml">Export as HTML</button>
          <button class="bigBtn" id="exportMd">Export as Markdown</button>
          <button class="bigBtn" id="exportJson">Export as JSON</button>
          <button class="bigBtn" id="shareBtn">Share (if supported)</button>
        </div>
        <div class="divider"></div>
        <div class="importBox">
          <div class="importHead">
            <div>
              <div class="importTitle">Quick prompt paste</div>
              <div class="hint">Paste prompts from your friend ‚Äî one per line ‚Äî then apply.</div>
            </div>
            <button class="btn" id="applyPromptPaste">Apply to today</button>
          </div>
          <textarea id="promptPaste" placeholder="Prompt 1&#10;Prompt 2&#10;Prompt 3"></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- History -->
  <div class="modalBackdrop hidden" id="historyModal" role="dialog" aria-modal="true" aria-label="History">
    <div class="modal wide">
      <div class="modalHead">
        <h3>History</h3>
        <button class="iconbtn" id="closeHistory" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="historyBar">
          <input id="historySearch" type="text" placeholder="Search headlines, prompts, or text..." />
          <button class="btn" id="exportAllHtml">Export all as HTML (index)</button>
        </div>
        <div class="historyList" id="historyList"></div>
      </div>
    </div>
  </div>

  
  <!-- Templates -->
  <div class="modalBackdrop hidden" id="templatesModal" role="dialog" aria-modal="true" aria-label="Templates">
    <div class="modal wide">
      <div class="modalHead">
        <h3>Templates</h3>
        <button class="iconbtn" id="closeTemplates" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="tplGrid">
          <button class="tplCard" id="tplDay1">
            <div class="tplTitle">NIXON ‚Äî Day 1</div>
            <div class="tplDesc">Homecoming intro + guided questions + truth receipt.</div>
          </button>
          <button class="tplCard" id="tplBlank">
            <div class="tplTitle">Blank day</div>
            <div class="tplDesc">One empty prompt. Your own flow.</div>
          </button>
        </div>
        <div class="hint" style="margin-top:10px;">Tip: Templates won‚Äôt overwrite your writing ‚Äî they‚Äôll replace the single empty prompt, or append to existing items.</div>
      </div>
    </div>
  </div>

  <!-- Fullscreen editor -->
  <div class="modalBackdrop hidden" id="editorModal" role="dialog" aria-modal="true" aria-label="Editor">
    <div class="modal wide editor">
      <div class="modalHead">
        <h3 id="editorTitle">Edit</h3>
        <button class="iconbtn" id="closeEditor" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="editorGrid">
          <label class="field">
            <div class="fieldLabel">Prompt</div>
            <textarea id="editorPrompt" class="editorArea" placeholder="Prompt‚Ä¶"></textarea>
          </label>
          <label class="field">
            <div class="fieldLabel">Response</div>
            <textarea id="editorAnswer" class="editorArea" placeholder="Response‚Ä¶"></textarea>
          </label>
        </div>
        <div class="hint" style="margin-top:10px;">Autosaves as you type. Esc closes.</div>
      </div>
    </div>
  </div>

  <!-- Help -->
  <div class="modalBackdrop hidden" id="helpModal" role="dialog" aria-modal="true" aria-label="Help">
    <div class="modal">
      <div class="modalHead">
        <h3>Help</h3>
        <button class="iconbtn" id="closeHelp" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBody prose">
        <p><strong>Daily flow:</strong> pick a date, paste prompts (Export ‚Üí Quick prompt paste), write, and it autosaves.</p>
        <p><strong>Export:</strong> use Export for HTML/Markdown/JSON, or Print/PDF for a beautiful shareable snapshot.</p>
        <p><strong>Backups:</strong> use ‚ÄúBackup all‚Äù weekly (or after a big week). Local storage isn‚Äôt magic ‚Äî devices die.</p>
        <p><strong>Privacy:</strong> entries are stored on this device only. Anyone with access to this device + browser profile can potentially view them.</p>
      </div>
    </div>
  </div>

  <template id="promptItemTpl">
    <div class="promptItem">
      <div class="promptTop">
        <div class="promptNum"></div>
        <div class="promptTopBtns">
          <button class="iconbtn expandBtn" title="Expand" aria-label="Expand">‚§¢</button>
          <button class="iconbtn danger removeBtn" title="Remove prompt" aria-label="Remove prompt">‚úï</button>
        </div>
      </div>
      <label class="field">
        <div class="fieldLabel">Prompt</div>
        <textarea class="promptText" placeholder="Paste the prompt here..."></textarea>
      </label>
      <label class="field">
        <div class="fieldLabel">Response</div>
        <textarea class="promptAnswer" placeholder="Your response..."></textarea>
      </label>
    </div>
  </template>

  <script type="module" src="assets/app.js?v=9"></script>
</body>
</html>
